#Make the project multi-module

Owner: netty

Repo: netty

Labels: cleanup 

## trustin (17 Nov 2011)

Netty project is growing.  We need to split into multiple submodules.


## trustin (17 Nov 2011)

In terms of resulting JARs, I'm thinking of the following directory/file organization in our tarball:

```
/lib/
    /DEPENDENCIES.txt (describes the dependencies between netty-*.jar files. generated by machine)
    /netty-all.jar (netty-core.jar + netty-extra.jar)
    /netty-core.jar (contains all JARs in the 'core' dir)
    /netty-extra.jar (contains all JARs in the 'extra' dir)
    /core/
         /netty-util.jar
         /netty-buffer.jar
         /netty-io.jar
         /netty-io-oio.jar
         /netty-io-nio.jar
         /netty-io-local.jar
         /...
    /extra/
          /netty-io-sctp.jar
          /netty-codec-http.jar
          /netty-codec-*.jar
          /...
```

By doing this, we provide both fine-grained and coarse-grained JARs that meet most people's interest.  The build will become more complicated though.


## veebs (17 Nov 2011)

How about the examples?  Should it be in its own examples.jar or you only get examples with the source code?


## trustin (18 Nov 2011)

Nice catch.  How about /lib/netty-examples.jar and letting people play with it guided by user guide?

```
java -cp netty-all.jar:netty-examples.jar \
      io.netty.example.http.snoop.HttpServer
```

netty-all.jar should not include netty example classes obviously.

Vibul Imtarnasan wrote:

> How about the examples?  Should it be in its own examples.jar or you only get examples with the source code?
> 
> ---
> 
> Reply to this email directly or view it on GitHub:
> https://github.com/netty/netty/issues/60#issuecomment-2783901


## normanmaurer (18 Nov 2011)

makes sense..


## trustin (27 Dec 2011)

It's not easy with Maven to generate such additional JARs like netty-all.jar / netty-core.jar / netty-extra.jar and deploy them to the central repo because of the limitation Maven enforces.  Let me try a couple other options to see what I can do.


## trustin (28 Dec 2011)

I've just created a branched called 'modularization'.  Please review.  I'll leave it for a couple days and then replace master with it.  Until then, please do not push anything into master otherwise we might miss some commits during replacement.


## trustin (28 Dec 2011)

Oh, I forgot to mention the layout looks different from what I initially proposed.  Please consider this as the first step.  Let's see what people think about it and we can split event more granularly.  IMHO the current layout is in good balance between modularization and fragmentation though.


## qmx (28 Dec 2011)

looks good :)


## veebs (28 Dec 2011)

Thanks Trustin.

Looks great :-)  2 questions:
1. I note that there is a separate codec-http project.  What criteria would make a codec belong in its own project? Size?
2. Test suite.  Would this be better split out so that each project has its own tests?

Vibul


## trustin (11 Jan 2012)

1) Yeah, HTTP codec is fairly large and I guess it will get larger as time goes by.
2) Tests that belong to a sole submodule should go to the submodule.  The test suite is an integration test.


## jamestyrrell (19 Jan 2012)

I couldn't find any information on the following but in commit 8663716 NamedThreadFactory and OSGi support has been removed. Is there an alternative to NamedThreadFactory? And will OSGi support be coming back?


## normanmaurer (19 Jan 2012)

Ups... OSGI support should been kept. Let me have a look soon.


## trustin (19 Jan 2012)

Yeah we should add OSGi support again. NamedThreadFactory was removed 
during modularization because it really doesn't belong to Netty but some 
other utility library. Please let us know if there is a good reason to 
keep it.


## jamestyrrell (19 Jan 2012)

I suppose NamedThreadFactory is a little generic. I still think that it is a useful utility class to have though within Netty, especially since Netty's operation often involves the creation of a number of threads.


